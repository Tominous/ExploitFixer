package dev._2lstudios.exploitfixer.utils;

import io.netty.buffer.ByteBuf;

public class ProtocolUtil {
    private static int SEGMENT_BITS = 0x7F;
    private static int CONTINUE_BIT = 0x80;

    public static int readVarInt(ByteBuf byteBuf) {
        int value = 0;
        int position = 0;
        byte currentByte;
    
        while (byteBuf.isReadable()) {
            currentByte = byteBuf.readByte();
            value |= (currentByte & SEGMENT_BITS) << position;
    
            if ((currentByte & CONTINUE_BIT) == 0) break;
    
            position += 7;
    
            if (position >= 32) throw new RuntimeException("VarInt is too big");
        }
    
        return value;
    }
}
