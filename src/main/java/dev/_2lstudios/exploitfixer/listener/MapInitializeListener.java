package dev._2lstudios.exploitfixer.listener;

import org.bukkit.event.EventHandler;
import org.bukkit.event.Listener;
import org.bukkit.event.server.MapInitializeEvent;
import org.bukkit.map.MapView;

import dev._2lstudios.exploitfixer.managers.ModuleManager;

public class MapInitializeListener implements Listener {
    private ModuleManager moduleManager;

    public MapInitializeListener(ModuleManager moduleManager) {
        this.moduleManager = moduleManager;
    }

    @EventHandler(ignoreCancelled = true)
    public void onMapInitialize(MapInitializeEvent event) {
        if (moduleManager.getEventsModule().isDisableTracking()) {
            MapView mapView = event.getMap();

            try {
                if (mapView.isTrackingPosition()) {
                    mapView.setTrackingPosition(false);
                }
            } catch (NoSuchMethodError ex) {
                // Some versions won't support this method :(
            }
        }
    }
}
