package dev._2lstudios.exploitfixer.commands;

import org.bukkit.command.Command;
import org.bukkit.command.CommandExecutor;
import org.bukkit.command.CommandSender;
import org.bukkit.entity.Player;

import dev._2lstudios.exploitfixer.modules.MessagesModule;
import dev._2lstudios.exploitfixer.modules.NotificationsModule;

public class NotificationsCommand implements CommandExecutor {
    private NotificationsModule notificationsModule;
    private MessagesModule messagesModule;
    private String lang;

    public NotificationsCommand(NotificationsModule notificationsModule, MessagesModule messagesModule, String lang) {
        this.notificationsModule = notificationsModule;
        this.messagesModule = messagesModule;
        this.lang = lang;
    }

    @Override
    public boolean onCommand(CommandSender sender, Command command, String label, String[] args) {
        if (sender instanceof Player) {
            if (sender.hasPermission("exploitfixer.admin")
                    || sender.hasPermission("exploitfixer.notifications")) {
                String playerName = sender.getName();

                if (!notificationsModule.isNotifications(playerName)) {
                    notificationsModule.setNotifications(playerName, true);
                    sender.sendMessage(messagesModule.getEnable(lang));
                } else {
                    notificationsModule.setNotifications(playerName, false);
                    sender.sendMessage(messagesModule.getDisable(lang));
                }
            } else {
                sender.sendMessage(messagesModule.getPermission(lang));
            }
        } else {
            sender.sendMessage(messagesModule.getConsole(lang));
        }

        return true;
    }
}
